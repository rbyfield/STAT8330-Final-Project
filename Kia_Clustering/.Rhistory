# reading the data
nc_sst_orig <- nc_open('sstdata_011948_022018.nc')
nc_prec_orig <- nc_open('Pdata_011948_022018-1.nc')
##### sst variables
zlev <- ncvar_get(nc_sst_orig, "zlev")
# East Longitude (deg)
X_sst <- ncvar_get(nc_sst_orig, "X")
print (dim(X_sst))
# time from Jan. 1948 to Feb. 2018
# 12*(2018-1948)+1(Jan 2018)+1(Feb 2018) = 842
time_sst <- ncvar_get(nc_sst_orig, "T")
print (dim(time_sst))
# Latitude (deg)
Y_sst <- ncvar_get(nc_sst_orig, "Y")
print (dim(Y_sst))
sst_anom <- ncvar_get(nc_sst_orig, "anom")
print (dim(sst_anom))
image(x=X_sst, y=Y_sst, z=sst_anom[,,842],
col = hcl.colors(12, "YlOrRd", rev = TRUE),
xlab="East Longitude (deg)",
ylab="Latitude (deg)", main="sst Anomalies: Feb 2018")
##### precipitation variables
# East Longitude (deg)
X_prec <- ncvar_get(nc_prec_orig, "X")
print (dim(X_prec))
# time
time_prec <- ncvar_get(nc_prec_orig, "T")
print (dim(time_prec))
# Latitude (deg)
Y_prec <- ncvar_get(nc_prec_orig, "Y")
print (dim(Y_prec))
# Precipitation
prec <- ncvar_get(nc_prec_orig, "rain")
# reproduce the image in file
image(x=X_prec, y=Y_prec, z=prec[,,842],
col = hcl.colors(12, "YlOrRd", rev = TRUE),
xlab="West Longitude (deg)",
ylab="Latitude (deg)", main="Precipitation: Feb 2018")
############## explanatory
# prec is a tensor that has 842 (months)matrices of size [x=120,y=50]
#plot ()
time_sst1 = time_sst * 30.42
time_sst2 <- as.Date(time_sst1, origin="1960-1-1 00:00", tz="UTC")
time_prec1 = time_prec * 30.42
time_prec2 <- as.Date(time_prec1, origin="1960-1-1 00:00", tz="UTC")
prec_mean <- apply(prec, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_prec2,prec=prec_mean)
tempseries %>% ggplot(aes(x=year,y=prec))+geom_line()+
labs(title = "Monthly mean precipitation from Jan. 1948 to Feb. 2018", x="year",y="Precipitation")
sst_mean <- apply(sst_anom, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_sst2, temperature=sst_mean)
tempseries %>% ggplot(aes(x=year,y=temperature))+geom_line()+
labs(title = "Monthly mean Temperature from Jan. 1948 to Feb. 2018", x="year",y="SST anamolies")
#temperature for each month
par(mfrow=c(2,1))
tempseries <- data.frame(year=time_sst,sst=sst_mean)
month_mean_sst = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_sst[month] = month_mean_sst[month] + tempseries[i,2]
}
month_mean_sst = data.frame(month_num=factor(c(1:12)),
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"), sst=month_mean_sst)
ggplot(month_mean_sst, aes(x=factor(month_num),y=sst))+geom_point(aes(x=month_num,y=sst)) + scale_x_discrete(breaks = factor(c(1:12)),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean SST for each month", x="month",y="Temperature" )
tempseries <- data.frame(year=time_prec,prec=prec_mean)
month_mean_prec = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_prec[month] = month_mean_prec[month] + tempseries[i,2]
}
month_mean_prec = data.frame(month_num=factor(c(1:12)), prec=month_mean_prec,
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
ggplot(month_mean_prec, aes(x=factor(month_num),y=prec))+geom_point(aes(x=month_num,y=prec)) + scale_x_discrete(breaks = c(1:12),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean Precipitation for each month", x="month",y="Temperature")
# dimension reduction
# Clustering
# prediction
knitr::opts_chunk$set(echo = TRUE)
library(ncdf4)
library(lubridate)
library(ggplot2)
library(tidyverse)
#install.packages("ggthemes")
library(ggthemes)
#install.packages("forecast")
library(forecast)
library(reshape2)
library(zoo)
#install.packages ("ggfortify")
library(ggfortify)
library(magrittr) # needs to be run every time you start R and want to use %>%
library(dplyr)    # alternatively, this also loads %>%
# write your code and push the changes. then I will merge the files to gether.
# needed packages ---------------------------------------------------------
# uncomment install lines if you do not have the package and comment them after you are done!
#install.packages("ncdf4")
library(ncdf4) # package for netcdf manipulation
#install.packages("raster")
library(raster) # package for raster manipulation
#install.packages("rgda1")
library(rgdal) # package for geospatial analysis
library(ggplot2) # package for plotting
# reading the data
nc_sst_orig <- nc_open('sstdata_011948_022018.nc')
nc_prec_orig <- nc_open('Pdata_011948_022018-1.nc')
##### sst variables
zlev <- ncvar_get(nc_sst_orig, "zlev")
# East Longitude (deg)
X_sst <- ncvar_get(nc_sst_orig, "X")
print (dim(X_sst))
# time from Jan. 1948 to Feb. 2018
# 12*(2018-1948)+1(Jan 2018)+1(Feb 2018) = 842
time_sst <- ncvar_get(nc_sst_orig, "T")
print (dim(time_sst))
# Latitude (deg)
Y_sst <- ncvar_get(nc_sst_orig, "Y")
print (dim(Y_sst))
sst_anom <- ncvar_get(nc_sst_orig, "anom")
print (dim(sst_anom))
image(x=X_sst, y=Y_sst, z=sst_anom[,,842],
col = hcl.colors(12, "YlOrRd", rev = TRUE),
xlab="East Longitude (deg)",
ylab="Latitude (deg)", main="sst Anomalies: Feb 2018")
##### precipitation variables
# East Longitude (deg)
X_prec <- ncvar_get(nc_prec_orig, "X")
print (dim(X_prec))
# time
time_prec <- ncvar_get(nc_prec_orig, "T")
print (dim(time_prec))
# Latitude (deg)
Y_prec <- ncvar_get(nc_prec_orig, "Y")
print (dim(Y_prec))
# Precipitation
prec <- ncvar_get(nc_prec_orig, "rain")
# reproduce the image in file
image(x=X_prec, y=Y_prec, z=prec[,,842],
col = hcl.colors(12, "YlOrRd", rev = TRUE),
xlab="West Longitude (deg)",
ylab="Latitude (deg)", main="Precipitation: Feb 2018")
############## explanatory
# prec is a tensor that has 842 (months)matrices of size [x=120,y=50]
#plot ()
time_sst1 = time_sst * 30.42
time_sst2 <- as.Date(time_sst1, origin="1960-1-1 00:00", tz="UTC")
time_prec1 = time_prec * 30.42
time_prec2 <- as.Date(time_prec1, origin="1960-1-1 00:00", tz="UTC")
prec_mean <- apply(prec, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_prec2,prec=prec_mean)
tempseries %>% ggplot(aes(x=year,y=prec))+geom_line()+
labs(title = "Monthly mean precipitation from Jan. 1948 to Feb. 2018", x="year",y="Precipitation")
sst_mean <- apply(sst_anom, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_sst2, temperature=sst_mean)
tempseries %>% ggplot(aes(x=year,y=temperature))+geom_line()+
labs(title = "Monthly mean Temperature from Jan. 1948 to Feb. 2018", x="year",y="SST anamolies")
#temperature for each month
par(mfrow=c(2,1))
tempseries <- data.frame(year=time_sst,sst=sst_mean)
month_mean_sst = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_sst[month] = month_mean_sst[month] + tempseries[i,2]
}
month_mean_sst = data.frame(month_num=factor(c(1:12)),
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"), sst=month_mean_sst)
ggplot(month_mean_sst, aes(x=factor(month_num),y=sst))+geom_point(aes(x=month_num,y=sst)) + scale_x_discrete(breaks = factor(c(1:12)),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean SST for each month", x="month",y="Temperature" )
tempseries <- data.frame(year=time_prec,prec=prec_mean)
month_mean_prec = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_prec[month] = month_mean_prec[month] + tempseries[i,2]
}
month_mean_prec = data.frame(month_num=factor(c(1:12)), prec=month_mean_prec,
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
ggplot(month_mean_prec, aes(x=factor(month_num),y=prec))+geom_point(aes(x=month_num,y=prec)) + scale_x_discrete(breaks = c(1:12),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean Precipitation for each month", x="month",y="Precipitation")
# dimension reduction
# Clustering
# prediction
par(mfrow=c(2,1))
tempseries <- data.frame(year=time_prec2,sst=sst_mean)
month_mean_sst = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_sst[month] = month_mean_sst[month] + tempseries[i,2]
}
############## explanatory
# prec is a tensor that has 842 (months)matrices of size [x=120,y=50]
#plot ()
time_sst1 = time_sst * 30.42
time_sst2 <- as.Date(time_sst1, origin="1960-1-1 00:00", tz="UTC")
time_prec1 = time_prec * 30.42
time_prec2 <- as.Date(time_prec1, origin="1960-1-1 00:00", tz="UTC")
prec_mean <- apply(prec, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_prec2,prec=prec_mean)
tempseries %>% ggplot(aes(x=year,y=prec))+geom_line()+
labs(title = "Monthly mean precipitation from Jan. 1948 to Feb. 2018", x="year",y="Precipitation")
sst_mean <- apply(sst_anom, 3, mean,na.rm=TRUE)
tempseries <- data.frame(year=time_sst2, temperature=sst_mean)
tempseries %>% ggplot(aes(x=year,y=temperature))+geom_line()+
labs(title = "Monthly mean Temperature from Jan. 1948 to Feb. 2018", x="year",y="SST anamolies")
#temperature for each month
par(mfrow=c(2,1))
tempseries <- data.frame(year=time_prec2,sst=sst_mean)
month_mean_sst = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_sst[month] = month_mean_sst[month] + tempseries[i,2]
}
month_mean_sst = data.frame(month_num=factor(c(1:12)),
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"), sst=month_mean_sst)
ggplot(month_mean_sst, aes(x=factor(month_num),y=sst))+geom_point(aes(x=month_num,y=sst)) + scale_x_discrete(breaks = factor(c(1:12)),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean SST for each month", x="month",y="Temperature" )
tempseries <- data.frame(year=time_prec2,prec=prec_mean)
month_mean_prec = rep(0, 12)
for (i in 1:nrow(tempseries))
{
month = as.numeric(substr(as.character(tempseries[i,1]),6,7))
month_mean_prec[month] = month_mean_prec[month] + tempseries[i,2]
}
month_mean_prec = data.frame(month_num=factor(c(1:12)), prec=month_mean_prec,
month_name=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
ggplot(month_mean_prec, aes(x=factor(month_num),y=prec))+geom_point(aes(x=month_num,y=prec)) + scale_x_discrete(breaks = c(1:12),
labels=c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")) +
labs(title = "Mean Precipitation for each month", x="month",y="Precipitation")
# dimension reduction
# Clustering
# prediction
sst_anom
time_sst
time_sst2
time_sst3
time_sst1
time_sst
month_id = data.frame()
range(1,100)
seq(1,12)
seq(1,842)
months <- seq(1,12)
index <- seq(1,842)
months <- seq(1,12)
months
month_id = data.frame(months, index)
rep(months)
rep(months,2)
842/12
months_ <- rep(months,70)
months
months_
length_months_
length(months_)
months_[841,842]=c(1,2)
months_[841]=1
months_[842]=2
month_id = data.frame(months_, index)
month_id
month_mean_sst = rep(0, 12)
month_mean_sst
month_mean_prec
months <- rep(seq(1,12),842/12)
months
months_id <- c(rep(seq(1,12),842/12),1,2)
months_id
months <- c(rep(seq(1,12),842/12),1,2)
ids <- seq(1,842)
months_id <- data.frame (ids, months)
months <- c(rep(seq(1,12),842/12),1,2)
ids <- seq(1,842)
months_id <- data.frame (ids, months)
months_id
months <- c(rep(seq(1,12),842/12),1,2)
month_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
ids <- seq(1,842)
months_id <- data.frame (ids, months, month_name)
rep(month_name,5)
months <- c(rep(seq(1,12),842/12),1,2)
month_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months <- c(rep(month_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
months_id <- data.frame (ids, months, month_name)
months <- c(rep(month_name,842/12), "Jan", "Feb")
months
length(months)
months <- c(rep(seq(1,12),842/12),1,2)
month_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(month_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
months_id <- data.frame (ids, months, month_name)
length(month_name)
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
months_id <- data.frame (ids, months, months_name)
months_id
time_prec2
sst_mean
years <- seq(rep(seq(1948,2018),12))
years
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
years <- seq(rep(seq(1948,2018),12))
months_id <- data.frame (ids, months, months_name)
months_id
years <- seq(rep(seq(1948,2018),12))
years
years <- seq(1984,2018)
years
for year in years{
for (year in years){
print (year)
}
years <- list()
year <- seq(1984,2018)
year <- seq(1984,2018)
years <- list()
counter=1
for (year in year){
for (i in range(1:12)){
years[counter] = year
counter = counter+1
}
}
years
range(1:12)
for (year in year){
for (i in seq(1,12)){
years[counter] = year
counter = counter+1
}
}
ids <- seq(1,842)
year <- seq(1984,2018)
years <- list()
counter=1
for (year in year){
for (i in seq(1,12)){
years[counter] = year
counter = counter+1
}
}
years
length(years)
length(year)
year <- seq(1984,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years
length(years)
counter
length(year)
35*12
2018-1948
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
months_id <- data.frame (ids, months, months_name)
years
years <- years[1:842]
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years <- years[1:842]
months_id <- data.frame (ids, months, months_name, years)
months_id
years
head(months_name)
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years <- years[1:842]
months_id <- data.frame (ids, months, months_name)
months_id
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years <- years[1:842]
months_years_id <- data.frame (ids, months, months_name)
months_years_id ["year"] = years
length(years)
length(months)
list(years)
years[10]
years[10,1]
years[10,2]
years[10]
typeof(years)
years[[1]]
do.call(rbind.data.frame, years)
colnames(years) <- c(id, year)
years <- years[1:842]
years <- do.call(rbind.data.frame, years)
colnames(years) <- c(id, year)
years <- years[1:842]
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years <- years[1:842]
years <- do.call(rbind.data.frame, years)
colnames(years) <- c('id', 'year')
months <- c(rep(seq(1,12),842/12),1,2)
months_name <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
months_name <- c(rep(months_name,842/12), "Jan", "Feb")
ids <- seq(1,842)
year <- seq(1948,2018)
years <- list()
counter=1
for (y in year){
for (i in seq(1,12)){
years[counter] = y
counter = counter+1
}
}
years <- years[1:842]
years <- do.call(rbind.data.frame, years)
colnames(years) <- c('year')
years
head(years)
months_years_id <- data.frame (ids, months, months_name)
months_years_id ["year"] = years
months_years_id
months_years_id[842]
months_years_id[841]
months_years_id["842"]
months_years_id["1"]
head(months_years_id)
seq(1,842,12)
months_years_id ["prec_mean"] <- prec_mean
plot(months_years_id["id"],months_years_id["prec_mean"])
months_years_id["id"]
plot(months_years_id["prec_mean"])
head((months_years_id["prec_mean"]))\
head((months_years_id["prec_mean"]))
head(months_years_id)
plot(months_years_id["ids"],months_years_id["prec_mean"])
months_years_id["ids"]
plot(months_years_id["ids"],months_years_id["prec_mean"])
months_years_id %>% ggplot(aes(x=years,y=prec_mean))+geom_line()+
labs(title = "Monthly mean Temperature from Jan. 1948 to Feb. 2018", x="year",y="SST anamolies")
months_years_id %>% ggplot(aes(x=year,y=prec_mean))+geom_line()+
labs(title = "Monthly mean Temperature from Jan. 1948 to Feb. 2018", x="year",y="SST anamolies")
